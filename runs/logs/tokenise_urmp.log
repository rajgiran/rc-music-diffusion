[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ╔══════════════════════════════════════════════════════════════════════════════╗
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ║                           MIDI TOKENIZATION - URMP                           ║
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ╚══════════════════════════════════════════════════════════════════════════════╝
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] Configuration:
[2025-08-29 20:14:25] [tokenise_urmp] [INFO]   • MIDI directory  : /scratch/rc01492/data/raw/urmp
[2025-08-29 20:14:25] [tokenise_urmp] [INFO]   • Output directory: /scratch/rc01492/data/processed/urmp/tokens
[2025-08-29 20:14:25] [tokenise_urmp] [INFO]   • Vocabulary      : /scratch/rc01492/data/processed/project_vocab.json
[2025-08-29 20:14:25] [tokenise_urmp] [INFO]   • Workers         : 24
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ✓ Using existing vocabulary: 626 tokens (hash: 6a6fa7a8)
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] PHASE 1: File Discovery
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ✓ Found 88 MIDI files
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] PHASE 2: File Validation
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:25] [tokenise_urmp] [INFO] ✓ Validating files with 24 workers...
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] Validation Results:
[2025-08-29 20:14:26] [tokenise_urmp] [INFO]   • Valid files  : 44 (50.0%)
[2025-08-29 20:14:26] [tokenise_urmp] [INFO]   • Invalid files: 44 (50.0%)
[2025-08-29 20:14:26] [tokenise_urmp] [INFO]   • Invalid file list saved to: skipped_corrupt_midis.txt
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] PHASE 3: Tokenization
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ✓ Processing 44 files with 24 workers...
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] PHASE 4: Saving Results
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ✓ Raw tokens saved → raw_tokens.pkl
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ✓ Metadata saved → metadata.json
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ✓ Chunks saved → chunks.pkl (289 chunks)
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] PHASE 5: Analysis & Preview
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ────────────────────────────────────────
[2025-08-29 20:14:26] [tokenise_urmp] [INFO] ✓ Creating diagnostic visualizations...
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ✓ Analysis plots saved → analysis.png
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ✓ Statistics saved → stats.json
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ✓ Generating preview from chunk 0 (454 tokens)
[2025-08-29 20:14:27] [tokenise_urmp] [INFO]   • MIDI saved → preview.mid
[2025-08-29 20:14:27] [tokenise_urmp] [INFO]   • Audio rendered with FluidSynth
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ✓ Audio preview saved → preview.wav (53.6s)
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] 
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ╔══════════════════════════════════════════════════════════════════════════════╗
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║                            TOKENIZATION COMPLETE                             ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ╠══════════════════════════════════════════════════════════════════════════════╣
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║ Duration       : 1.3 seconds                                                 ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║ Files processed: 44 / 44                                                     ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║ Success rate   : 100.0%                                                      ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║ Total sequences: 149                                                         ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║ Total chunks   : 289                                                         ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║ Avg chunks/file: 6.6                                                         ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ║ Output location: /scratch/rc01492/data/processed/urmp/tokens                 ║
[2025-08-29 20:14:27] [tokenise_urmp] [INFO] ╚══════════════════════════════════════════════════════════════════════════════╝
